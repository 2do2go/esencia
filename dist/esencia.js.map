{"version":3,"sources":["lib/classes/collection.js","lib/classes/componentsManager.js","lib/classes/model.js","lib/classes/router.js","lib/classes/view.js","lib/esencia.js","lib/utils/componentsManager.js","lib/utils/exec.js","lib/utils/extend.js"],"names":["_","_require","backbone","execUtils","Collection","sync","method","collection","options","prepareOptions","getFakeBaseMethod","prototype","call","exec","extend","parse","success","resp","fetch","reset","context","trigger","wrapError","module","exports","View","isTreeNodeChanged","oldNode","node","Boolean","component","name","view","isWaiting","attached","isUnchanged","ComponentsManager","pick","componentManagerOptions","components","tree","autoAddRoot","_addRoot","initialize","apply","arguments","componentOptions","Events","rootEl","defaultParent","RootView","el","add","parent","defaults","process","has","uniqueId","isString","Error","isNull","container","get","remove","names","callback","isArray","noop","_buildTree","oldTree","_applyTree","children","self","buildHashedTree","length","parentNames","nodes","chain","uniq","map","push","compact","value","each","find","child","isEmpty","filter","some","params","afterCallback","after","iterate","oldChildren","setData","setView","renderViews","include","attachViews","exclude","union","render","index","detach","result","listenToOnce","Model","model","serverAttrs","set","componentsManager","Router","namedParameters","nowhereUrl","autoloadModules","modulesPath","defaultModuleName","onModuleError","routerOptions","constructor","urlParams","modules","route","setModule","_populateUrlParams","key","isObject","isFunction","extendOwn","url","componentNames","pluck","join","args","defaultUrlParams","_defaultMiddleware","navigate","fragment","force","replace","omit","qs","toFragment","val","undefined","next","middleware","defaultMiddleware","moduleName","split","identity","require","moduleInit","$","splice","Array","delegateEventSplitter","nestedEventTypes","isContainerSkipped","contains","templateHelpers","waitsCounter","waitAvailable","viewOptions","views","collections","models","data","template","_prepareEvents","_prepareViews","wait","delegateNestedEvents","once","defer","_render","html","renderTemplate","getTemplateData","$el","setElement","_ensureElement","$container","attach","viewsGroup","first","containerEl","domChanged","$els","append","_updateViews","setViews","appendView","_insertViews","appendViews","prependView","prependViews","insertView","insertViews","removeView","getView","_removeViews","removeViews","getViews","clone","concat","oldViews","all","oldView","viewObjs","indexOf","viewObj","sortBy","undelegateNestedEvents","element","$previousEl","_setElement","replaceWith","delegateEvents","events","type","entities","listeners","_nestedEventsHash","listener","entity","listenTo","eventName","handler","stopListening","typeEventsHash","match","entityKeys","bind","entityKey","afterAttach","previousView","attr","cid","detachViews","beforeDetach","removeData","removeAttr","undelegateEvents","getClosestView","selector","$selector","is","closest","Esencia","backboneFields","DEFAULT_EXEC_TYPE","urlError","error","dataType","contentType","processData","JSON","stringify","baseMethodsMap","toUpperCase"],"mappings":"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","file":"esencia.js","sourceRoot":".","sourcesContent":["'use strict';\n\nvar _ = require('underscore');\nvar backbone = require('backbone');\nvar execUtils = require('../utils/exec');\n\n/**\n * @class Esencia.Collection\n * @extend Backbone.Collection\n */\n\nvar Collection = {};\n\n/**\n * Override `sync` to add exec custom method functionality\n *\n * @override\n */\n\nCollection.sync = function(method, collection, options) {\n\toptions = execUtils.prepareOptions(method, collection, options);\n\tmethod = execUtils.getFakeBaseMethod(options);\n\treturn backbone.Collection.prototype.sync.call(\n\t\tthis, method, collection, options\n\t);\n};\n\n/**\n * Exec custom non-REST method on collection\n * It trigger `exec:[method]` event after success method exec\n *\n * @param {String} method\n * @param {Object} options\n */\n\nCollection.exec = function(method, options) {\n\toptions = _.extend({parse: true}, options);\n\tvar collection = this;\n\tvar success = options.success;\n\toptions.success = function(resp) {\n\t\tif (options.fetch) collection[options.reset ? 'reset' : 'set'](resp, options);\n\t\tif (success) success.call(options.context, collection, resp, options);\n\t\tcollection.trigger('exec:' + method, collection, resp, options);\n\t};\n\texecUtils.wrapError(this, options);\n\treturn this.sync(method, this, options);\n};\n\nmodule.exports = backbone.Collection.extend(Collection);\n","'use strict';\n\nvar _ = require('underscore');\nvar backbone = require('backbone');\nvar View = require('./view');\nvar extend = require('../utils/extend');\n\nfunction isTreeNodeChanged(oldNode, node) {\n\treturn Boolean(\n\t\t!oldNode ||\n\t\toldNode.component.name !== node.component.name ||\n\t\t!oldNode.view ||\n\t\toldNode.view instanceof node.component.View === false ||\n\t\toldNode.view.isWaiting() ||\n\t\t!oldNode.view.attached ||\n\t\t!oldNode.view.isUnchanged()\n\t);\n}\n\n/**\n * @class Esencia.ComponentsManager\n */\n\nvar ComponentsManager = function(options) {\n\t// populate ComponentsManager instance with fields from options\n\t_.extend(this, _.pick(options, componentManagerOptions));\n\t// save original options, it is sometimes usefull\n\tthis.options = options;\n\n\t// all components hash\n\tthis.components = {};\n\n\t// current components tree that rendered at this moment\n\tthis.tree = [];\n\n\t// add default root component, in most cases this is what you need\n\tif (this.autoAddRoot) this._addRoot();\n\n\tthis.initialize.apply(this, arguments);\n};\n\nvar componentManagerOptions = [\n\t'rootEl', 'autoAddRoot', 'defaultParent'\n];\n\n var componentOptions = [\n\t'name', 'parent', 'container', 'View', 'models', 'collections', 'viewOptions'\n];\n\n_.extend(ComponentsManager.prototype, backbone.Events, {\n\t// You can set selector of any element at the page if you want restrict\n\t// specific page area that component manager will process\n\trootEl: 'html',\n\n\t// Add default root component, in most cases this is what you need\n\tautoAddRoot: true,\n\n\t// Default parent component name, this option will set as first root\n\t// component name\n\tdefaultParent: null,\n\n\t/**\n\t * Initialize is an empty function by default. Override it with your own\n\t * initialization logic.\n\t */\n\n\tinitialize: function() {},\n\n\t/**\n\t * Add default root component to the components list\n\t */\n\n\t_addRoot: function() {\n\t\tvar RootView = View.extend({\n\t\t\tel: this.rootEl\n\t\t});\n\n\t\tthis.add({\n\t\t\tname: '__ROOT_COMPONENT__',\n\t\t\tparent: null,\n\t\t\tView: RootView\n\t\t});\n\t},\n\n\t/**\n\t * Add component to the components list\n\t *\n\t * @param {Object} options\n\t * @param {String} options.name - component name\n\t * @param {View} options.View - component view constructor\n\t * @param {String|Null} [options.parent] - component parent name or null\n\t * for roots\n\t * @param {String} [options.container] - view container, required if parent\n\t * is string\n\t * @param {Boolean} [options.process] - process component after add\n\t */\n\n\tadd: function(options) {\n\t\toptions = _.defaults({}, options, {\n\t\t\tparent: this.defaultParent,\n\t\t\tprocess: false\n\t\t});\n\n\t\tvar component = _.pick(options, componentOptions);\n\n\t\tif (!_.has(component, 'name')) {\n\t\t\tcomponent.name = _.uniqueId('__COMPONENT_') + '__';\n\t\t}\n\n\t\tif (!_.isString(component.name)) {\n\t\t\tthrow new Error('Component `name` option should be a string');\n\t\t}\n\n\t\tif (_.has(this.components, component.name)) {\n\t\t\tthrow new Error('Duplicate component with name \"' + component.name + '\"');\n\t\t}\n\n\t\tif (!_.has(component, 'View')) {\n\t\t\tthrow new Error('Component `View` option is required');\n\t\t}\n\n\t\tif (!_.isString(component.parent) && !_.isNull(component.parent)) {\n\t\t\tthrow new Error('Component `parent` option should be a string or null');\n\t\t}\n\n\t\tif (_.isNull(component.parent) && _.has(component, 'container')) {\n\t\t\tthrow new Error('Root component could not have a container');\n\t\t}\n\n\t\tif (_.isString(component.parent) && !_.has(component, 'container')) {\n\t\t\tthrow new Error(\n\t\t\t\t'Component `container` option is required for components with parent'\n\t\t\t);\n\t\t}\n\n\t\tif (_.has(component, 'container') && !_.isString(component.container)) {\n\t\t\tthrow new Error('Component `container` option should be a string');\n\t\t}\n\n\t\tthis.components[component.name] = component;\n\n\t\tif (_.isNull(this.defaultParent) && _.isNull(component.parent)) {\n\t\t\tthis.defaultParent = component.name;\n\t\t}\n\n\t\t// process components tree in force mode\n\t\tif (options.process) {\n\t\t\tthis.process(component.name);\n\t\t}\n\n\t\treturn component;\n\t},\n\n\t/**\n\t * Get component by name\n\t *\n\t * @param {String} name - component name\n\t * @return {Object} component\n\t */\n\n\tget: function(name) {\n\t\treturn this.components[name] || null;\n\t},\n\n\t/**\n\t * Remove component by name\n\t *\n\t * @param {String} name - component name\n\t */\n\n\tremove: function(name) {\n\t\tdelete this.components[name];\n\t},\n\n\t/**\n\t * Process components tree by name(s) and call a callback on done\n\t *\n\t * @param {String|String[]} names - component name or names list\n\t * @params {Function} [callback]\n\t */\n\n\tprocess: function(names, callback) {\n\t\tif (!_.isArray(names)) names = [names];\n\t\tcallback = callback || _.noop;\n\n\t\tvar tree = this._buildTree(names);\n\t\tvar oldTree = this.tree;\n\t\tthis.tree = [];\n\n\t\tthis._applyTree({\n\t\t\tparent: {children: this.tree},\n\t\t\toldTree: oldTree,\n\t\t\ttree: tree\n\t\t}, callback);\n\t},\n\n\t_buildTree: function(names) {\n\t\tvar self = this;\n\n\t\t// internal function for recursion\n\t\tvar buildHashedTree = function(names, tree) {\n\t\t\t// exit with empty tree if names list is empty\n\t\t\tif (!names.length) return tree;\n\n\t\t\tvar parentNames = [];\n\n\t\t\t// create component nodes\n\t\t\tvar nodes = _(names)\n\t\t\t\t.chain()\n\t\t\t\t.uniq()\n\t\t\t\t.map(function(name) {\n\t\t\t\t\tvar component = self.components[name];\n\n\t\t\t\t\tif (!component) {\n\t\t\t\t\t\tthrow new Error('Unknown component with name \"' + name + '\"');\n\t\t\t\t\t}\n\n\t\t\t\t\t// skip component if it is already in the tree\n\t\t\t\t\tif (_.has(tree, component.name)) return null;\n\n\t\t\t\t\t// create node\n\t\t\t\t\tvar node = {\n\t\t\t\t\t\tcomponent: component,\n\t\t\t\t\t\tchildren: []\n\t\t\t\t\t};\n\n\t\t\t\t\t// add parent name to the list\n\t\t\t\t\tif (_.isString(component.parent)) {\n\t\t\t\t\t\tparentNames.push(component.parent);\n\t\t\t\t\t}\n\n\t\t\t\t\t// add nodes to the hashed tree first to prevent cycles\n\t\t\t\t\ttree[component.name] = node;\n\n\t\t\t\t\treturn node;\n\t\t\t\t})\n\t\t\t\t.compact()\n\t\t\t\t.value();\n\n\t\t\t// build new tree for parent components\n\t\t\ttree = buildHashedTree(parentNames, tree);\n\n\t\t\t// add each node to the parent children list if component has a parent\n\t\t\t_(nodes).each(function(node) {\n\t\t\t\tif (_.isString(node.component.parent)) {\n\t\t\t\t\tif (\n\t\t\t\t\t\tnode.component.container &&\n\t\t\t\t\t\t_(tree[node.component.parent].children).find(function(child) {\n\t\t\t\t\t\t\treturn child.component.container === node.component.container;\n\t\t\t\t\t\t})\n\t\t\t\t\t) {\n\t\t\t\t\t\tthrow new Error(\n\t\t\t\t\t\t\t'Components could not have same container and parent in one tree'\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\ttree[node.component.parent].children.push(node);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn tree;\n\t\t};\n\n\t\tvar tree = buildHashedTree(names, {});\n\n\t\tif (_.isEmpty(tree)) {\n\t\t\tthrow new Error('Components tree is empty');\n\t\t}\n\n\t\t// filter root components\n\t\ttree = _(tree).filter(function(node) {\n\t\t\treturn _.isNull(node.component.parent);\n\t\t});\n\n\t\tif (!tree.length) {\n\t\t\tthrow new Error('Components tree should have at least one root node');\n\t\t}\n\n\t\tif (\n\t\t\t_(tree).some(function(node) {\n\t\t\t\treturn node.component.container;\n\t\t\t})\n\t\t) {\n\t\t\tthrow new Error('Root component could not have a container');\n\t\t}\n\n\t\treturn tree;\n\t},\n\n\t_applyTree: function(params, callback) {\n\t\tvar self = this;\n\n\t\tvar parent = params.parent;\n\n\t\tvar afterCallback = _.after(params.tree.length, callback);\n\n\t\tvar iterate = function(oldNode, node) {\n\t\t\tvar container = node.component.container;\n\n\t\t\tvar children = node.children;\n\t\t\tvar oldChildren = oldNode ? oldNode.children : [];\n\n\t\t\t// set view data\n\t\t\tnode.view.setData();\n\n\t\t\tif (!node.view.attached && container) {\n\t\t\t\t// render view with container from parent view\n\t\t\t\tparent.view\n\t\t\t\t\t.setView(node.view, container)\n\t\t\t\t\t.renderViews({include: [container]})\n\t\t\t\t\t.attachViews({include: [container]});\n\t\t\t} else {\n\t\t\t\t// exclude list is an union of old and new children\n\t\t\t\tvar exclude = _.union(\n\t\t\t\t\t_(children).chain().map(function(child) {\n\t\t\t\t\t\treturn child.component.container;\n\t\t\t\t\t}).compact().value(),\n\t\t\t\t\t_(oldChildren).chain().map(function(child) {\n\t\t\t\t\t\treturn child.component.container;\n\t\t\t\t\t}).compact().value()\n\t\t\t\t);\n\n\t\t\t\t// render view without container directly\n\t\t\t\tnode.view.render({exclude: exclude});\n\t\t\t}\n\n\t\t\t// clear children field in new node because it will set recursive\n\t\t\t// and should be empty in error case\n\t\t\tnode.children = [];\n\n\t\t\t// save node to the parent children\n\t\t\tparent.children.push(node);\n\n\t\t\t// recursive call for children nodes\n\t\t\tself._applyTree({\n\t\t\t\tparent: node,\n\t\t\t\toldTree: oldChildren,\n\t\t\t\ttree: children\n\t\t\t}, afterCallback);\n\t\t};\n\n\t\t_(params.tree).each(function(node, index) {\n\t\t\t// TODO get oldNode in better way\n\t\t\tvar oldNode = params.oldTree[index] || null;\n\n\t\t\tif (isTreeNodeChanged(oldNode, node)) {\n\t\t\t\tif (oldNode && oldNode.view) {\n\t\t\t\t\tif (oldNode.component.container) {\n\t\t\t\t\t\t// remove old view if container for new view dirrent\n\t\t\t\t\t\tif (oldNode.component.container !== node.component.container) {\n\t\t\t\t\t\t\toldNode.view.remove();\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// detach old view if it has not a container\n\t\t\t\t\t\toldNode.view.detach();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// create new view\n\t\t\t\tnode.view = new (node.component.View)(\n\t\t\t\t\t_(node.component)\n\t\t\t\t\t\t.chain()\n\t\t\t\t\t\t.pick('models', 'collections')\n\t\t\t\t\t\t.extend(_.result(node.component, 'viewOptions'))\n\t\t\t\t\t\t.value()\n\t\t\t\t);\n\n\t\t\t\t// stop processing old components tree by passing null as oldNode\n\t\t\t\tif (node.view.isWaiting()) {\n\t\t\t\t\t// wait when view will be resolved\n\t\t\t\t\tself.listenToOnce(node.view, 'resolve', function() {\n\t\t\t\t\t\titerate(null, node);\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\titerate(null, node);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// save old view to new node\n\t\t\t\tnode.view = oldNode.view;\n\n\t\t\t\t// process old components tree\n\t\t\t\titerate(oldNode, node);\n\t\t\t}\n\t\t});\n\t}\n});\n\nComponentsManager.extend = extend;\n\nmodule.exports = ComponentsManager;\n","'use strict';\n\nvar _ = require('underscore');\nvar backbone = require('backbone');\nvar execUtils = require('../utils/exec');\n\n/**\n * @class Esencia.Model\n * @extend Backbone.Model\n */\n\nvar Model = {};\n\n/**\n * Override `sync` to add exec custom method functionality\n *\n * @override\n */\n\nModel.sync = function(method, model, options) {\n\toptions = execUtils.prepareOptions(method, model, options);\n\tmethod = execUtils.getFakeBaseMethod(options);\n\treturn backbone.Model.prototype.sync.call(this, method, model, options);\n};\n\n/**\n * Exec custom non-REST method on model\n * It trigger `exec:[method]` event after success method exec\n *\n * @param {String} method\n * @param {Object} options\n */\n\nModel.exec = function(method, options) {\n\toptions = _.extend({parse: true}, options);\n\tvar model = this;\n\tvar success = options.success;\n\toptions.success = function(resp) {\n\t\tif (options.fetch) {\n\t\t\tvar serverAttrs = options.parse ? model.parse(resp, options) : resp;\n\t\t\tif (!model.set(serverAttrs, options)) return false;\n\t\t}\n\t\tif (success) success.call(options.context, model, resp, options);\n\t\tmodel.trigger('exec:' + method, model, resp, options);\n\t};\n\texecUtils.wrapError(this, options);\n\treturn this.sync(method, this, options);\n};\n\nmodule.exports = backbone.Model.extend(Model);\n","'use strict';\n\nvar _ = require('underscore');\nvar backbone = require('backbone');\nvar componentsManager = require('../utils/componentsManager');\n\n/**\n * @class Esencia.Router\n * @extend Backbone.Router\n */\n\nvar Router = {\n\t// root: '/',\n\tcomponentsManager: componentsManager,\n\tnamedParameters: false,\n\tnowhereUrl: '___',\n\tautoloadModules: true,\n\tmodulesPath: 'modules/',\n\tdefaultModuleName: 'main',\n\tonModuleError: function() {}\n};\n\nvar routerOptions = [\n\t// 'root',\n\t'componentsManager', 'namedParameters', 'nowhereUrl',\n\t'autoloadModules', 'modulesPath', 'defaultModuleName', 'onModuleError'\n];\n\n/**\n * @constructor\n * @param {Object} [options]\n */\n\nRouter.constructor = function(options) {\n\toptions = options || {};\n\n\t// populate Router instance with fields from options\n\t_.extend(this, _.pick(options, routerOptions));\n\t// save original options, it is sometimes usefull\n\tthis.options = options;\n\n\tthis.urlParams = {};\n\tthis.modules = {};\n\n\t// All query parameters can be passed in a single hash using the key\n\t// referenced from the route definition (backbone queryparams will\n\t// do it for us)\n\tbackbone.Router.namedParameters = this.namedParameters;\n\n\tbackbone.Router.apply(this, arguments);\n\n\tif (options.autoloadModules) {\n\t\tthis.route('*url', function(params) {\n\t\t\tthis.setModule(params);\n\t\t});\n\t}\n};\n\n/**\n * Extend all arguments to single object and replace urlParams with it\n *\n * @param {Object | Function} params1\n * @param {Object | Function} params2\n * etc. ...\n */\n\nRouter._populateUrlParams = function(/* params1, params2, ... */) {\n\tvar self = this;\n\n\t// clean old values from urlParams object\n\tvar key;\n\tfor (key in this.urlParams) {\n\t\tif (_.has(this.urlParams, key)) {\n\t\t\tdelete this.urlParams[key];\n\t\t}\n\t}\n\n\t// populate urlParams with new params\n\t_(arguments)\n\t\t.chain()\n\t\t.filter(_.isObject)\n\t\t.each(function(params) {\n\t\t\tparams = _.isFunction(params) ? params.call(self) : params;\n\t\t\t_.extendOwn(self.urlParams, params);\n\t\t});\n\n\treturn this.urlParams;\n};\n\n/**\n * Add new component to components manager\n *\n * @param {Object} options - component options\n */\n\nRouter.component = function(options) {\n\treturn this.componentsManager.add(options);\n};\n\n/**\n * Override `route` to add middleware processing functionality\n *\n * @override\n */\n\nRouter.route = function(url, options, callback) {\n\tvar self = this;\n\n\tif (_.isFunction(options)) {\n\t\tcallback = options;\n\t\toptions = {};\n\t}\n\n\tif (!_.isObject(options)) {\n\t\toptions = {name: options};\n\t}\n\n\tvar name = '';\n\n\tif (_.has(options, 'components') || _.has(options, 'component')) {\n\t\tvar components = _(options.components || [options.component])\n\t\t\t.map(function(componentOptions) {\n\t\t\t\treturn self.component(componentOptions);\n\t\t\t});\n\n\t\tvar componentNames = _.pluck(components, 'name');\n\n\t\tname = componentNames.join(',');\n\n\t\t// create callback to process components tree\n\t\tcallback = function() {\n\t\t\tself.componentsManager.process(componentNames);\n\t\t};\n\t}\n\n\tname = options.name || name;\n\n\t// bind component to route\n\tbackbone.Router.prototype.route.call(this, url, name, function() {\n\t\tvar args = arguments;\n\n\t\tself._populateUrlParams(options.defaultUrlParams, args[0]);\n\n\t\tself._defaultMiddleware({\n\t\t\turl: url,\n\t\t\tname: name,\n\t\t\tcallback: callback\n\t\t}, function() {\n\t\t\tcallback.apply(self, args);\n\t\t});\n\t});\n};\n\n/**\n * Override `navigate` to add force mode and qs processing\n *\n * @override\n * @param {String} fragment\n * @param {Object} [options] - hash of params\n * @param {Object} [options.qs] - query string hash\n */\n\nRouter.navigate = function(fragment, options) {\n\toptions = options || {};\n\n\t// if (fragment.indexOf(this.root) === 0) {\n\t// \tfragment = fragment.substring(this.root.length);\n\t// }\n\n\t// force to go to the selected fragment even if we currently on it\n\tif (options.force) {\n\t\tthis.navigate(this.nowhereUrl, {\n\t\t\treplace: options.replace,\n\t\t\ttrigger: false\n\t\t});\n\n\t\toptions = _(options).chain().omit('force').extend({replace: true}).value();\n\n\t\treturn this.navigate(fragment, options);\n\t}\n\n\t// set `trigger` to true by default\n\toptions = _.defaults({}, options, {\n\t\ttrigger: true,\n\t\tparams: {}\n\t});\n\n\t// add support of query string using `toFragment` from backbone.queryparams\n\tvar qs = options.qs;\n\n\tif (this.toFragment && qs) {\n\t\t// reject undefined and null qs parameters\n\t\t_(qs).each(function(val, key, qs) {\n\t\t\tif (val === undefined || val === null) delete qs[key];\n\t\t});\n\n\t\tfragment = this.toFragment(fragment, qs);\n\n\t\tdelete options.qs;\n\t}\n\n\tbackbone.Router.prototype.navigate.call(this, fragment, options);\n};\n\n\n/**\n * Default middleware function\n */\n\nRouter._defaultMiddleware = function(route, next) {\n\tnext();\n};\n\n/**\n * Use passed function as `middleware`\n *\n * @param {Function} middleware - middleware function,\n * `route` and `next` will be passed as arguments.\n * context (`this`) is link to the router object.\n */\n\nRouter.middleware = function(middleware) {\n\tvar self = this;\n\n\tvar defaultMiddleware = this._defaultMiddleware;\n\n\tthis._defaultMiddleware = function(route, next) {\n\t\tdefaultMiddleware.call(self, route, function() {\n\t\t\tmiddleware.call(self, route, next);\n\t\t});\n\t};\n\n\treturn this;\n};\n\n/**\n * Require module file and init it\n *\n * @param {Object} params\n * @param {String} params.url - url without query string\n */\n\nRouter.setModule = function(params) {\n\tvar self = this;\n\n\tvar url = params.url;\n\tdelete params.url;\n\n\tvar moduleName = _(url.split('/')).find(_.identity) || this.defaultModuleName;\n\n\t// require module file\n\trequire([this.modulesPath + moduleName], function(moduleInit) {\n\t\t// if module is loaded first time\n\t\tif (!self.modules[moduleName]) {\n\t\t\t// init it\n\t\t\tmoduleInit(self);\n\n\t\t\t// set module init flag to true\n\t\t\tself.modules[moduleName] = true;\n\n\t\t\t// and navigate again with force flag\n\t\t\tself.navigate(url, {\n\t\t\t\treplace: true,\n\t\t\t\tforce: true,\n\t\t\t\tqs: params\n\t\t\t});\n\t\t}\n\t}, this.onModuleError);\n};\n\nmodule.exports = backbone.Router.extend(Router);\n","'use strict';\n\nvar _ = require('underscore');\nvar backbone = require('backbone');\n\n// Take jquery or other selectors lib from backbone\nvar $ = backbone.$;\n\nvar splice = Array.prototype.splice;\n\n// Cached regex to split keys for `delegate`.\nvar delegateEventSplitter = /^(\\S+)\\s*(.*)$/;\n\n// List of events type for nested entities processed by current view\nvar nestedEventTypes = ['views', 'collections', 'models'];\n\nfunction isContainerSkipped(container, options) {\n\treturn Boolean(\n\t\t(options.exclude && _.contains(options.exclude, container)) ||\n\t\t(options.include && !_.contains(options.include, container))\n\t);\n}\n\n/**\n * @class Esencia.View\n * @extend Backbone.View\n */\n\nvar View = {\n\t// Helpers (Object|Fuction) which will be passed to the template\n\ttemplateHelpers: {},\n\n\t// Views are in the resolved state by default\n\twaitsCounter: 0,\n\n\t// This flag is used to check that .wait() is called\n\t// in the constructor/initialize\n\twaitAvailable: true,\n\n\t// Views are not attached by default\n\tattached: false\n};\n\nvar viewOptions = [\n\t'views', 'collections', 'models', 'data', 'events', 'router', 'templateHelpers'\n];\n\n/**\n * @constructor\n * @param {Object} [options]\n */\n\nView.constructor = function(options) {\n\tvar self = this;\n\n\toptions = options || {};\n\n\t// nested views, collections, models and data are empty by default\n\tthis.views = {};\n\tthis.collections = {};\n\tthis.models = {};\n\tthis.data = {};\n\n\t// populate View instance with fields from options\n\t_.extend(this, _.pick(options, viewOptions));\n\t// save original options, it is sometimes usefull\n\tthis.options = options;\n\n\tif (this.template && !_.isFunction(this.template)) {\n\t\tthrow new Error('View `template` option should be a function');\n\t}\n\n\t// create special hash object for all events for fast search\n\tthis._prepareEvents();\n\n\t// normalize nested views hash\n\tthis._prepareViews();\n\n\t// apply default backbone.View constructor\n\tbackbone.View.apply(this, arguments);\n\n\t// set waiting state for current view if some nested view is in waiting state\n\t_(this.views).each(function(views) {\n\t\t_(views).each(function(view) {\n\t\t\tif (view.isWaiting()) {\n\t\t\t\tself.listenToOnce(view, 'resolve', self.wait());\n\t\t\t}\n\t\t});\n\t});\n\n\t// disable .wait(), it available only in the constructor/initialize\n\tthis.waitAvailable = false;\n\n\t// we should delegate events after parent constructor call because\n\t// collections and models could be created in the initialize method\n\n\t// delegate events for each collection\n\t_(this.collections).each(function(collection, key) {\n\t\tself.delegateNestedEvents('collections', key, collection);\n\t});\n\n\t// delegate events for each model\n\t_(this.models).each(function(model, key) {\n\t\tself.delegateNestedEvents('models', key, model);\n\t});\n};\n\n/**\n * Update view data\n * Method is used to update view state, could be overriden to modify nested\n * views state\n *\n * @param {Object} [data] - new data object\n * @return {Esencia.View} - view instance for chaining\n */\n\nView.setData = function(data) {\n\tif (data) this.data = data;\n\treturn this;\n};\n\n/**\n * Check that view is changed and should be re-rendered\n * Method returns true by default (always unchanged), could be overriden\n * for specific logic\n *\n * @return {Boolean}\n */\n\nView.isUnchanged = function() {\n\treturn true;\n};\n\n/**\n * Switch view to the waiting state\n *\n * @return {Function} - callback function, should be called to resolve view\n */\n\nView.wait = function() {\n\tif (!this.waitAvailable) {\n\t\tthrow new Error('Method .wait() is available only in the constructor');\n\t}\n\n\tvar self = this;\n\n\tthis.waitsCounter++;\n\n\t// TODO: think about promises\n\treturn _.once(function() {\n\t\t_.defer(function() {\n\t\t\tself.waitsCounter--;\n\t\t\tif (!self.isWaiting()) {\n\t\t\t\tself.trigger('resolve');\n\t\t\t}\n\t\t});\n\t});\n};\n\n/**\n * Check view waiting state\n *\n * @return {Boolean}\n */\n\nView.isWaiting = function() {\n\treturn this.waitsCounter > 0;\n};\n\n/**\n * Render view\n *\n * @param {Object} options\n * @param {Boolean} options.force\n * @return {Esencia.View} - view instance for chaining\n */\n\nView._render = function(options) {\n\t// stop rendering if view in `waiting` state, resolve it first\n\tif (this.isWaiting()) return this;\n\n\toptions = options || {};\n\n\tif (this.template) {\n\t\t// re-render template only if it exists and if it is necessary\n\t\tif (options.force || !this.attached || !this.isUnchanged()) {\n\t\t\t// detach view from DOM element\n\t\t\tthis.detach();\n\n\t\t\t// render template with data\n\t\t\tvar html = this.renderTemplate(this.template, this.getTemplateData());\n\n\t\t\t// render html with jqeury (or other lib) call\n\t\t\tvar $el = $(html);\n\n\t\t\tif (!$el.length) {\n\t\t\t\tthrow new Error('View template produces empty html');\n\t\t\t}\n\n\t\t\tif ($el.length > 1) {\n\t\t\t\tthrow new Error(\n\t\t\t\t\t'View template produces html with more than one root elements'\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis.setElement($el);\n\t\t}\n\t} else {\n\t\t// re-ensure element if it is not ensured\n\t\tif (!this.$el.length) this._ensureElement();\n\t}\n\n\t// render nested views\n\tthis.renderViews(options);\n\n\tif (!this.parent || this.$container) {\n\t\t// attach all nested views first\n\t\tthis.attachViews(options);\n\n\t\t// attach current view\n\t\tthis.attach();\n\t}\n\n\t// return this for chaining\n\treturn this;\n};\n\n/**\n * Render view by calling private _render method\n *\n * @override\n * @return {Esencia.View} - view instance for chaining\n */\n\nView.render = function(options) {\n\treturn this._render(options);\n};\n\n/**\n * Get data for template rendering\n * Returns data by default, could be overriden\n *\n * @return {Object}\n */\n\nView.getTemplateData = function() {\n\treturn this.data;\n};\n\n/**\n * Render template with data. Returns html.\n *\n * @param {Function} template - template function for rendering\n * @param {Object} data - data for rendering\n * @return {String} - rendered html\n */\n\nView.renderTemplate = function(template, data) {\n\tdata = _(this).chain().result('templateHelpers').extend(data).value();\n\n\t// get html\n\treturn template(data);\n};\n\n/**\n * Render all nested view\n *\n * @param {Object} options\n * @param {Boolean} options.force\n * @return {Esencia.View} - view instance for chaining\n*/\n\nView.renderViews = function(options) {\n\tvar self = this;\n\n\t// iterate by each views group\n\t_(this.views).each(function(viewsGroup, container) {\n\t\tif (isContainerSkipped(container, options)) return;\n\n\t\t// return if view group is empty\n\t\tif (!viewsGroup.length) return;\n\n\t\t// call render for each views from view group\n\t\t_(viewsGroup).each(function(view) {\n\t\t\tview.render(_.omit(options, 'include', 'exclude'));\n\t\t});\n\n\t\t// get first container or $el\n\t\tvar $container = container ? self.$(container).first() : self.$el;\n\n\t\tif (!$container.length) {\n\t\t\tthrow new Error('Container \"' + container + '\" is not found');\n\t\t}\n\n\t\tvar containerEl = $container.get(0);\n\n\t\t// dom is changed if some view from group is not in current container\n\t\tvar domChanged = _(viewsGroup).some(function(view) {\n\t\t\treturn (\n\t\t\t\t!view.attached ||\n\t\t\t\t!view.$container ||\n\t\t\t\tview.$container.get(0) !== containerEl\n\t\t\t);\n\t\t});\n\n\t\tif (domChanged) {\n\t\t\t// re-append views group to container\n\t\t\tvar $els = [];\n\n\t\t\t_(viewsGroup).each(function(view) {\n\t\t\t\tview.$container = $container;\n\t\t\t\t$els.push(view.$el);\n\t\t\t});\n\n\t\t\t// TODO: add some rendering optimizations here\n\n\t\t\t// put all views to $container\n\t\t\t$container.append($els);\n\t\t}\n\t});\n\n\t// return this for chaining\n\treturn this;\n};\n\n/**\n * Set view to views group or replace some view in specified position\n * If index is passed it replace only one view with index in views group\n *\n * @param {Esencia.View} view - view to set\n * @param {String} container - container to set\n * @param {Number} [index] - index of view to replace\n * @return {Esencia.View} - view instance for chaining\n */\n\nView.setView = function(view, container, index) {\n\treturn this._updateViews([view], container, index);\n};\n\n/**\n * Set views to views group or replace some view in specified position\n * If index is passed it replace only one view with index in views group\n *\n * @param {Esencia.View[]} views - views to set\n * @param {String} container - container to set\n * @param {Number} [index] - index of view to replace\n * @return {Esencia.View} - view instance for chaining\n */\n\nView.setViews = function(views, container, index) {\n\treturn this._updateViews(views, container, index);\n};\n\n/**\n * Append view to end of views group\n * This method is alias for insertView without index argument\n *\n * @param {Esencia.View} view - view to append\n * @param {String} container - container of views group\n * @return {Esencia.View} - view instance for chaining\n */\n\nView.appendView = function(view, container) {\n\treturn this._insertViews([view], container);\n};\n\n/**\n * Append views to end of views group\n * This method is alias for insertViews without index argument\n *\n * @param {Esencia.View[]} views - views to append\n * @param {String} container - container of views group\n * @return {Esencia.View} - view instance for chaining\n */\n\nView.appendViews = function(views, container) {\n\treturn this._insertViews(views, container);\n};\n\n/**\n * Prepend view to start of views group\n * This method is alias for insertView with `0` as index argument value\n *\n * @param {Esencia.View} view - view to prepend\n * @param {String} container - container of views group\n * @return {Esencia.View} - view instance for chaining\n */\n\nView.prependView = function(view, container) {\n\treturn this._insertViews([view], container, 0);\n};\n\n/**\n * Prepend views to start of views group\n * This method is alias for insertViews with `0` as index argument value\n *\n * @param {Esencia.View[]} views - view to prepend\n * @param {String} container - container of views group\n  * @return {Esencia.View} - view instance for chaining\n */\n\nView.prependViews = function(views, container) {\n\treturn this._insertViews(views, container, 0);\n};\n\n/**\n * Insert view to specified position of views group in the container\n * If index is not passed method inserts view to the end of views group (append)\n *\n * @param {Esencia.View} view - view to insert\n * @param {String} container - container of views group\n * @param {Number} [index] - position in views group\n * @return {Esencia.View} - view instance for chaining\n */\n\nView.insertView = function(view, container, index) {\n\treturn this._insertViews([view], container, index);\n};\n\n/**\n * Insert views to specified position of views group container\n * If index is not passed method inserts views to the end of views group\n *\n * @param {Esencia.View[]} views - views to insert\n * @param {String} container - container of views group\n * @param {Number} [index] - position in views group\n * @return {Esencia.View} - view instance for chaining\n */\n\nView.insertViews = function(views, container, index) {\n\treturn this._insertViews(views, container, index);\n};\n\n/**\n * Remove view from views group container by index or view instance\n * If index is passed it remove view in the index position\n *\n * @param {Esencia.View} [view] - view to remove\n * @param {String} container - container of views group\n * @param {Number} [index] - index of view in views group\n * @return {Esencia.View} - view instance for chaining\n */\n\nView.removeView = function(view, container, index) {\n\tif (arguments.length < 2) {\n\t\tthrow new Error('\"view\" or \"index\" arguments must be specified');\n\t}\n\n\tif (_.isString(view)) {\n\t\tindex = container;\n\t\tcontainer = view;\n\t\tview = this.getView(container, index);\n\t\tif (!view) return this;\n\t}\n\n\treturn this._removeViews([view], container);\n};\n\n/**\n * Remove views from views group container\n * If views are passed remove only these views\n * Othervise remove all views from container\n *\n * @param {Esencia.View[]} [views] - views to remove\n * @param {String} container - container of views group\n * @return {Esencia.View} - view instance for chaining\n */\n\nView.removeViews = function(views, container) {\n\tif (_.isString(views)) {\n\t\tcontainer = views;\n\t\tviews = this.getViews(container);\n\t}\n\n\treturn this._removeViews(views, container);\n};\n\n/**\n * Get single view from container by index\n *\n * @param {String} container - container of views group\n * @param {Number} [index] - index of view in views group\n * @return {Esencia.View}\n */\n\nView.getView = function(container, index) {\n\treturn this.getViews(container)[index || 0] || null;\n};\n\n/**\n * Get views group from container\n *\n * @param {String} container - container of views group\n * @return {Esencia.View[]}\n */\n\nView.getViews = function(container) {\n\treturn _.clone(this.views[container]) || [];\n};\n\nView._insertViews = function(views, container, index) {\n\tvar self = this;\n\n\tvar viewsGroup = this.getViews(container);\n\n\t_(views).each(function(view) {\n\t\tif (view.parent) {\n\t\t\tview.parent.removeView(view, view.container);\n\t\t}\n\t});\n\n\tif (viewsGroup.length) {\n\t\t// if index is not specified set it value as last index of views group\n\t\tif (typeof index === 'undefined') {\n\t\t\tindex = viewsGroup.length;\n\t\t}\n\n\t\t// insert views\n\t\tsplice.apply(this.views[container], [index, 0].concat(views));\n\t} else {\n\t\t// if group is empty - set views as whole views group value\n\t\tthis.views[container] = views;\n\t}\n\n\t// set each view parent to current\n\t_(views).each(function(view) {\n\t\tview.parent = self;\n\t\tview.container = container;\n\t});\n\n\tthis.delegateNestedEvents('views', container, views);\n\n\treturn this;\n};\n\nView._updateViews = function(views, container, index) {\n\tvar oldViews;\n\n\tif (typeof index === 'undefined') {\n\t\t// if no index - get all views from group as old\n\t\toldViews = this.getViews(container);\n\t} else {\n\t\t// if index is specified get view from specific position as old\n\t\toldViews = this.getView(container, index);\n\t\toldViews = oldViews ? [oldViews] : [];\n\t}\n\n\t// exit if views equal oldViews\n\tif (\n\t\toldViews.length === views.length &&\n\t\t_(oldViews).all(function(oldView, index) {\n\t\t\treturn oldView === views[index];\n\t\t})\n\t) return this;\n\n\tif (oldViews.length) {\n\t\t// if old views array is not empty remove them from parent view\n\t\tthis._removeViews(oldViews, container);\n\n\t\t// and remove views from DOM\n\t\t_(oldViews).each(function(view) {\n\t\t\tview.remove();\n\t\t});\n\t}\n\n\t// insert new views\n\treturn this._insertViews(views, container, index);\n};\n\nView._removeViews = function(views, container) {\n\tvar self = this;\n\n\tvar viewsGroup = this.getViews(container);\n\n\tif (!viewsGroup.length) return this;\n\n\tvar viewObjs = _(views)\n\t\t.chain()\n\t\t.uniq()\n\t\t.map(function(view) {\n\t\t\treturn {\n\t\t\t\tview: view,\n\t\t\t\tindex: _.indexOf(viewsGroup, view)\n\t\t\t};\n\t\t})\n\t\t.filter(function(viewObj) {\n\t\t\treturn viewObj.index >= 0;\n\t\t})\n\t\t.sortBy(function(viewObj) {\n\t\t\treturn -viewObj.index;\n\t\t})\n\t\t.value();\n\n\tif (!viewObjs.length) return this;\n\n\t_(viewObjs).each(function(viewObj) {\n\t\tvar view = viewObj.view;\n\n\t\t// remove item from group\n\t\tsplice.call(self.views[container], viewObj.index, 1);\n\n\t\t// undelegate all nested entity events\n\t\tself.undelegateNestedEvents(view);\n\n\t\t// unset view parent\n\t\tdelete view.parent;\n\t});\n\n\treturn this;\n};\n\n/**\n * Original setElement do undelegateEvents/delegateEvents, we remove it\n * because we have special detach/attach methods for this purpose\n *\n * @override\n * @return {Esencia.View} - view instance for chaining\n */\n\nView.setElement = function(element) {\n\tvar $previousEl = this.$el;\n\n\tthis._setElement(element);\n\n\t// insert html to $el\n\tif ($previousEl && this.$container) {\n\t\t$previousEl.replaceWith(this.$el);\n\t}\n\n\treturn this;\n};\n\n/**\n * @override\n */\n\nView.delegateEvents = function(events) {\n\tevents = events || _.result(this, 'events');\n\tif (!events) return this;\n\tevents = _.omit(events, nestedEventTypes);\n\treturn backbone.View.prototype.delegateEvents.call(this, events);\n};\n\nView.delegateNestedEvents = function(type, key, entities) {\n\tvar self = this;\n\tif (!_.isArray(entities)) entities = [entities];\n\tvar listeners = this._nestedEventsHash[type][key];\n\tif (listeners) {\n\t\t_(listeners).each(function(listener) {\n\t\t\t_(entities).each(function(entity) {\n\t\t\t\tself.listenTo(entity, listener.eventName, listener.handler);\n\t\t\t});\n\t\t});\n\t}\n\treturn this;\n};\n\nView.undelegateNestedEvents = function(entities) {\n\tvar self = this;\n\tif (!_.isArray(entities)) entities = [entities];\n\t_(entities).each(function(entity) {\n\t\tself.stopListening(entity);\n\t});\n\treturn this;\n};\n\nView._prepareEvents = function(events) {\n\tvar self = this;\n\n\t// Hash for nested views events fast search\n\tthis._nestedEventsHash = {};\n\t_(nestedEventTypes).each(function(type) {\n\t\tself._nestedEventsHash[type] = {};\n\t});\n\n\tevents = events || _.result(this, 'events');\n\tif (!events) return;\n\n\t// bind all prefixed events to view then call native delegate events\n\t_(nestedEventTypes).each(function(type) {\n\t\tvar typeEventsHash = self._nestedEventsHash[type];\n\n\t\tif (!_.has(events, type) || !_.isObject(events[type])) return;\n\n\t\t_(events[type]).each(function(method, key) {\n\t\t\tif (!_.isFunction(method)) method = self[method];\n\t\t\tif (!method) return;\n\t\t\tvar match = key.match(delegateEventSplitter);\n\t\t\tvar eventName = match[1];\n\t\t\tvar entityKeys = match[2].replace(/ *, */g, ',').split(',');\n\t\t\tmethod = _.bind(method, self);\n\n\t\t\t// fill _nestedEventsHash\n\t\t\t_(entityKeys).each(function(entityKey) {\n\t\t\t\ttypeEventsHash[entityKey] = typeEventsHash[entityKey] || [];\n\t\t\t\ttypeEventsHash[entityKey].push({\n\t\t\t\t\teventName: eventName,\n\t\t\t\t\thandler: method\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t});\n};\n\n/**\n * Wrap all non-array view groups to arrays with one element and delegate events\n */\n\nView._prepareViews = function() {\n\tvar self = this;\n\n\t_(this.views).each(function(views, container) {\n\t\tif (!_.isArray(views)) views = [views];\n\t\tself.views[container] = views;\n\t\tself.delegateNestedEvents('views', container, views);\n\t});\n};\n\n/**\n * Attach all nested views\n *\n * @return {Esencia.View} - view instance for chaining\n */\n\nView.attachViews = function(options) {\n\toptions = options || {};\n\n\t// iterate by each nested views groups\n\t_(this.views).each(function(viewsGroup, container) {\n\t\tif (isContainerSkipped(container, options)) return;\n\n\t\t// return if views group is empty\n\t\tif (!viewsGroup.length) return;\n\n\t\t// call attach method for each nested view from views group\n\t\t_(viewsGroup).each(function(view) {\n\t\t\t// recursive attach all nested views\n\t\t\tview.attachViews(_.omit(options, 'include', 'exclude'));\n\n\t\t\t// attach current view\n\t\t\tview.attach();\n\t\t});\n\t});\n\n\t// return this for chaining\n\treturn this;\n};\n\n/**\n * afterAttach is empty by default\n * It called after attach call, could be verriden to add some specific logic\n * for DOM manipulations\n *\n * @return {Esencia.View} - view instance for chaining\n */\n\nView.afterAttach = function() {\n\treturn this;\n};\n\n/**\n * Attach new view to current view $el\n *\n * @return {Esencia.View} - view instance for chaining\n */\n\nView.attach = function() {\n\t// return if current view is already attached\n\tif (this.attached) return this;\n\n\t// detach previous view\n\tvar previousView = this.$el.data('esencia-view');\n\tif (previousView) previousView.detach();\n\n\t// attach current view and set attr\n\tthis.$el.data('esencia-view', this).attr('esencia-view', this.cid);\n\n\t// enable all DOM events\n\tthis.delegateEvents();\n\n\tthis.attached = true;\n\n\t// do some user afterAttach actions\n\tthis.afterAttach();\n\n\t// trigger attach event\n\tthis.trigger('attach');\n\n\treturn this;\n};\n\n/**\n * Detach all nested views\n *\n * @return {Esencia.View} - view instance for chaining\n */\n\nView.detachViews = function() {\n\t// iterate by each views groups\n\t_(this.views).each(function(viewsGroup) {\n\t\t// return if views group is empty\n\t\tif (!viewsGroup.length) return;\n\n\t\t// call detach method for each nested view from views group\n\t\t_(viewsGroup).each(function(view) {\n\t\t\t// recursive detach all nested views\n\t\t\tview.detachViews();\n\n\t\t\t// detach current view\n\t\t\tview.detach();\n\t\t});\n\t});\n\n\t// return this for chaining\n\treturn this;\n};\n\n/**\n * beforeDetach is empty by default\n * It called before detach method call, could be overriden to add some specific\n * logic before view detach from dom\n *\n * @return {Esencia.View} - view instance for chaining\n */\n\nView.beforeDetach = function() {\n\treturn this;\n};\n\n/**\n * Detach view from current view $el\n *\n * @return {Esencia.View} - view instance for chaining\n */\n\nView.detach = function() {\n\t// return if current view is not already attached\n\tif (!this.attached) return this;\n\n\t// trigger detach event\n\tthis.trigger('detach');\n\n\t// do some user beforeDetach actions\n\tthis.beforeDetach();\n\n\t// remove attr and data from $el\n\tthis.$el.removeData('esencia-view').removeAttr('esencia-view');\n\n\t// disable all DOM events\n\tthis.undelegateEvents();\n\n\tthis.attached = false;\n\n\t// return this for chaining\n\treturn this;\n};\n\n/**\n * Remove view from parent container and remove element from DOM\n */\n\nView.remove = function() {\n\t// remove current view from parent view container\n\tif (this.parent) {\n\t\tthis.parent.removeView(this, this.container);\n\t}\n\n\t// detach all nested views first\n\tthis.detachViews();\n\n\t// detach current view\n\tthis.detach();\n\n\t// remove DOM element\n\treturn backbone.View.prototype.remove.call(this);\n};\n\n/**\n * Get view, that attached to closest element with attr `esencia-view`\n *\n * @param {String | $} selector\n * @return {Esencia.View | Null}\n */\n\nView.getClosestView = function(selector) {\n\tvar $selector = $(selector);\n\n\tif (!$selector.is('[esencia-view]')) {\n\t\t$selector = $selector.closest('[esencia-view]');\n\t}\n\n\treturn $selector.length ? $selector.data('esencia-view') : null;\n};\n\nmodule.exports = backbone.View.extend(View);\n","'use strict';\n\nvar backbone = require('backbone');\nvar _ = require('underscore');\nvar Router = require('./classes/router');\nvar Collection = require('./classes/collection');\nvar Model = require('./classes/model');\nvar View = require('./classes/view');\nvar ComponentsManager = require('./classes/componentsManager');\nvar componentsManager = require('./utils/componentsManager');\nvar extend = require('./utils/extend');\n\nvar Esencia = exports;\n\n// Allow the `Esencia` object to serve as a global event bus, for folks who\n// want global \"pubsub\" in a convenient place.\n_.extend(Esencia, backbone.Events);\n\n// Export some Backbone fields\nvar backboneFields = ['Events', 'History', 'history'];\n_.extend(Esencia, _.pick(backbone, backboneFields));\n\n// Export all Esencia classes\n_.extend(Esencia, {\n\tRouter: Router,\n\tCollection: Collection,\n\tModel: Model,\n\tView: View,\n\tComponentsManager: ComponentsManager\n});\n\n// Export the default Esencia.componentsManager\nEsencia.componentsManager = componentsManager;\n\n// Export extend helper for subclassing\nEsencia.extend = extend;\n","'use strict';\n\nvar ComponentsManager = require('../classes/componentsManager');\n\n// Create the default Esencia.componentsManager\nmodule.exports = new ComponentsManager();\n","'use strict';\n\nvar _ = require('underscore');\n\n// Default http method type for exec methods\nvar DEFAULT_EXEC_TYPE = 'PUT';\n\n// Throw an error when a URL is needed, and none is supplied.\nvar urlError = function() {\n\tthrow new Error('A \"url\" property or function must be specified');\n};\n\n// Wrap an optional error callback with a fallback error event.\nexports.wrapError = function(model, options) {\n\tvar error = options.error;\n\toptions.error = function(resp) {\n\t\tif (error) error.call(options.context, model, resp, options);\n\t\tmodel.trigger('error', model, resp, options);\n\t};\n};\n\nexports.prepareOptions = function(method, model, options) {\n\toptions = _.extend({\n\t\ttype: DEFAULT_EXEC_TYPE,\n\t\tdataType: 'json',\n\t\tcontentType: 'application/json',\n\t\tprocessData: false\n\t}, options);\n\n\t// Ensure that we have a URL and add method name to it\n\tif (!options.url) {\n\t\tvar url = _.result(model, 'url') || urlError();\n\t\toptions.url = url.replace(/[^\\/]$/, '$&/') + method;\n\t}\n\n\t// stringify data to json\n\tif (options.data && _.isObject(options.data) && !options.processData) {\n\t\toptions.data = JSON.stringify(options.data);\n\t}\n\n\treturn options;\n};\n\n// HTTP type to backbone sync methods map\nvar baseMethodsMap = {\n\t'POST': 'create',\n\t'PUT': 'update',\n\t'PATCH': 'patch',\n\t'DELETE': 'delete',\n\t'GET': 'read'\n};\n\nexports.getFakeBaseMethod = function(options) {\n\treturn baseMethodsMap[options.type.toUpperCase()];\n};\n","'use strict';\n\nvar backbone = require('backbone');\n\n// There is no good exports of extend method from backbone.\n// Take it from View and add to ComponentsManager because no other ways\nmodule.exports = backbone.View.extend;\n"]}